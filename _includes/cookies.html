{% if jekyll.environment == 'production' %}

<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js"></script>
<script>

    function enableGA() {
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', '{{site.google_analytics}}', 'auto');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
    }

    function disableGA() {
        window['ga-disable-{{site.google_analytics}}'] = true;
        clearCookie('_ga','.michaelporter.dev','/');
        clearCookie('_gat_gtag_{{site.google_analytics}}','.mydomain.com','/');
        clearCookie('_gid','.michaelporter.dev','/');

    }


    window.addEventListener("load", function(){
    window.cookieconsent.initialise({
        onInitialise: function (status) {
        var type = this.options.type;
        var didConsent = this.hasConsented();
        if (type == 'opt-in' && didConsent) {
            enableGA();
        }
        if (type == 'opt-out' && !didConsent) {
            // disable cookies
            disableGA();
        }
        },
        
        onStatusChange: function(status, chosenBefore) {
        var type = this.options.type;
        var didConsent = this.hasConsented();
        if (type == 'opt-in' && didConsent) {
            enableGA();
        }
        if (type == 'opt-out' && !didConsent) {
            // disable cookies
            disableGA();
        }
        },
        
        onRevokeChoice: function() {
        var type = this.options.type;
        if (type == 'opt-in') {
            // disable cookies
            disableGA();
        }
        if (type == 'opt-out') {
            enableGA();
        }
        },
        "palette": {
        "popup": {
        "background": "#efefef",
        "text": "#404040"
        },
        "button": {
        "background": "#8ec760",
        "text": "#ffffff"
        }
    },
    "type": "opt-out",
    "content": {
        "href": "https://3d.michaelporter.dev/privacy/"
    }
    })});
</script>

{% endif %}